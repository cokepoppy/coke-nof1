# NOF1.AI éƒ¨ç½²è¯´æ˜

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### æœåŠ¡å™¨ä¿¡æ¯
- **VPS IP**: 107.174.39.191
- **åŸŸå**: nof1.coke-twitter.com
- **SSH**: `ssh root@107.174.39.191`
- **å¯†ç **: [è¯·ä½¿ç”¨ä½ è‡ªå·±çš„VPSå¯†ç ]

### å‰ç½®æ¡ä»¶æ£€æŸ¥
- [ ] DNSè®°å½•å·²é…ç½®ï¼šnof1.coke-twitter.com â†’ 107.174.39.191
- [ ] å¯ä»¥SSHç™»å½•åˆ°VPS
- [ ] VPSä¸ŠMySQLå’ŒRediså·²å®‰è£…è¿è¡Œ
- [ ] ä¸ä¼šå½±å“ç°æœ‰æœåŠ¡ï¼ˆbinance.coke-twitter.comç­‰ï¼‰

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ­¥éª¤1ï¼šä¸Šä¼ é¡¹ç›®åˆ°VPS

åœ¨æœ¬åœ°æ‰§è¡Œï¼š
```bash
cd /mnt/d/home/coke-nof1

# ä¸Šä¼ é¡¹ç›®æ–‡ä»¶ï¼ˆæ’é™¤node_modulesç­‰ï¼‰
rsync -avz --exclude 'node_modules' --exclude 'dist' --exclude '.git' --exclude 'logs' \
  ./ root@107.174.39.191:/root/coke-nof1/
```

### æ­¥éª¤2ï¼šSSHç™»å½•VPS

```bash
ssh root@107.174.39.191
# è¾“å…¥å¯†ç : [ä½ çš„VPSå¯†ç ]

cd /root/coke-nof1
```

### æ­¥éª¤3ï¼šæ‰§è¡Œä¸€é”®éƒ¨ç½²

```bash
sudo bash deploy/quick-deploy.sh
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
1. âœ… å®‰è£…Node.js 20ã€PM2ã€Nginxã€Certbot
2. âœ… åˆ›å»ºæ•°æ®åº“ nof1_db å’Œç”¨æˆ· nof1_user
3. âœ… ç¼–è¯‘å¹¶éƒ¨ç½²åç«¯å’Œå‰ç«¯
4. âœ… é…ç½®PM2è‡ªåŠ¨å¯åŠ¨
5. âœ… é…ç½®Nginxå’ŒHTTPSè¯ä¹¦

### æ­¥éª¤4ï¼šé…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡

éƒ¨ç½²å®Œæˆåï¼Œéœ€è¦æ£€æŸ¥å¹¶æ›´æ–°é…ç½®ï¼š

```bash
# ç¼–è¾‘åç«¯é…ç½®
sudo nano /opt/nof1-app/backend/.env
```

**å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹**ï¼š
- `DB_PASSWORD` - ä¿®æ”¹ä¸ºæ›´å®‰å…¨çš„å¯†ç 
- `JWT_SECRET` - ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆå»ºè®®32ä½ä»¥ä¸Šï¼‰
- `OPENROUTER_API_KEY` - æ£€æŸ¥æ˜¯å¦æ­£ç¡®
- å…¶ä»–APIå¯†é’¥æ ¹æ®éœ€è¦é…ç½®

ä¿®æ”¹åé‡å¯æœåŠ¡ï¼š
```bash
pm2 restart nof1-service
```

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²ï¼ˆåˆ†æ­¥æ‰§è¡Œï¼‰

å¦‚æœæƒ³åˆ†æ­¥æ‰§è¡Œï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºï¼š

### 1. å®‰è£…åŸºç¡€ä¾èµ–
```bash
cd /root/coke-nof1/deploy
sudo bash scripts/install_basics_ubuntu.sh
```

### 2. åˆå§‹åŒ–MySQLæ•°æ®åº“
```bash
sudo bash scripts/init_mysql.sh
```
**æ³¨æ„**ï¼šè®°ä¸‹è¾“å‡ºçš„æ•°æ®åº“å‡­è¯ä¿¡æ¯ï¼

### 3. éƒ¨ç½²åº”ç”¨
```bash
sudo bash scripts/deploy_pm2.sh
```

### 4. é…ç½®Nginxå’ŒHTTPS
```bash
sudo bash scripts/setup_nginx.sh nof1.coke-twitter.com
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
/opt/nof1-app/              # åº”ç”¨éƒ¨ç½²ç›®å½•
â”œâ”€â”€ backend/                # åç«¯åº”ç”¨
â”‚   â”œâ”€â”€ dist/              # ç¼–è¯‘åçš„JSæ–‡ä»¶
â”‚   â”œâ”€â”€ .env               # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ logs/              # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ frontend/              # å‰ç«¯åº”ç”¨
    â””â”€â”€ dist/              # ç¼–è¯‘åçš„é™æ€æ–‡ä»¶
```

## ğŸ” éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥PM2çŠ¶æ€
```bash
pm2 status
pm2 logs nof1-service
```

### 2. æµ‹è¯•åç«¯API
```bash
# æœ¬åœ°æµ‹è¯•
curl http://localhost:3001/api/health

# å¤–éƒ¨æµ‹è¯•
curl https://nof1.coke-twitter.com/api/health
```

### 3. è®¿é—®ç½‘ç«™
åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š
- http://nof1.coke-twitter.com ï¼ˆä¼šè‡ªåŠ¨è·³è½¬åˆ°HTTPSï¼‰
- https://nof1.coke-twitter.com

### 4. æ£€æŸ¥æ—¥å¿—
```bash
# PM2æ—¥å¿—
pm2 logs nof1-service --lines 100

# Nginxè®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/nof1-access.log

# Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/nof1-error.log
```

## ğŸ›  å¸¸ç”¨ç»´æŠ¤å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
pm2 status                      # PM2è¿›ç¨‹çŠ¶æ€
sudo systemctl status nginx     # NginxçŠ¶æ€
sudo systemctl status mysql     # MySQLçŠ¶æ€
sudo systemctl status redis     # RedisçŠ¶æ€
```

### é‡å¯æœåŠ¡
```bash
pm2 restart nof1-service       # é‡å¯åç«¯
sudo systemctl restart nginx   # é‡å¯Nginx
```

### æŸ¥çœ‹æ—¥å¿—
```bash
pm2 logs nof1-service          # å®æ—¶æŸ¥çœ‹æ—¥å¿—
pm2 logs nof1-service --lines 200  # æŸ¥çœ‹æœ€è¿‘200è¡Œ
```

### æ›´æ–°åº”ç”¨

å½“æœ‰ä»£ç æ›´æ–°æ—¶ï¼š

```bash
# 1. åœ¨æœ¬åœ°åŒæ­¥ä»£ç 
rsync -avz --exclude 'node_modules' --exclude 'dist' --exclude '.git' \
  ./ root@107.174.39.191:/root/coke-nof1/

# 2. åœ¨VPSä¸Šé‡æ–°éƒ¨ç½²
cd /root/coke-nof1
sudo bash deploy/scripts/deploy_pm2.sh
```

## ğŸ“Š æŠ€æœ¯é…ç½®

### ç«¯å£é…ç½®
- **åç«¯**: 3001
- **å‰ç«¯**: é€šè¿‡Nginxåœ¨80/443ç«¯å£æä¾›æœåŠ¡
- **MySQL**: 3306
- **Redis**: 6379

### æ•°æ®åº“
- **æ•°æ®åº“å**: nof1_db
- **ç”¨æˆ·å**: nof1_user
- **å¯†ç **: nof1_pass_prod_2024 (é»˜è®¤ï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ï¼)

### PM2é…ç½®
- **è¿›ç¨‹å**: nof1-service
- **æ—¥å¿—è·¯å¾„**: /var/log/pm2/nof1-service.log
- **å¼€æœºè‡ªå¯**: å·²é…ç½®

### Nginxé…ç½®
- **é…ç½®æ–‡ä»¶**: /etc/nginx/sites-available/nof1.coke-twitter.com
- **SSLè¯ä¹¦**: Let's Encryptè‡ªåŠ¨ç»­æœŸ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¿®æ”¹é»˜è®¤å¯†ç **
   - éƒ¨ç½²ååŠ¡å¿…ä¿®æ”¹ `DB_PASSWORD` å’Œ `JWT_SECRET`

2. **APIå¯†é’¥å®‰å…¨**
   - ç¡®ä¿ `.env` æ–‡ä»¶æƒé™æ­£ç¡®
   - ä¸è¦å°†APIå¯†é’¥æäº¤åˆ°Git

3. **DNSé…ç½®**
   - ç”³è¯·SSLè¯ä¹¦å‰ç¡®ä¿DNSå·²ç”Ÿæ•ˆ
   - å¯ä»¥ç”¨ `ping nof1.coke-twitter.com` æµ‹è¯•

4. **é˜²ç«å¢™**
   - ç¡®ä¿å¼€æ”¾ 80ã€443 ç«¯å£
   - å»ºè®®é…ç½®UFWé˜²ç«å¢™

5. **å¤‡ä»½**
   - å®šæœŸå¤‡ä»½æ•°æ®åº“
   - ä¿å­˜å¥½ .env é…ç½®æ–‡ä»¶

## ğŸ†˜ å¸¸è§é—®é¢˜

### åç«¯å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
pm2 logs nof1-service

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat /opt/nof1-app/backend/.env

# æ‰‹åŠ¨æµ‹è¯•
cd /opt/nof1-app/backend
node dist/server.js
```

### å‰ç«¯æ— æ³•è®¿é—®
```bash
# æ£€æŸ¥ç¼–è¯‘äº§ç‰©
ls -la /opt/nof1-app/frontend/dist/

# æµ‹è¯•Nginxé…ç½®
sudo nginx -t

# é‡æ–°åŠ è½½Nginx
sudo systemctl reload nginx
```

### æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
mysql -u nof1_user -p

# æ£€æŸ¥MySQLçŠ¶æ€
sudo systemctl status mysql

# é‡æ–°åˆ›å»ºæ•°æ®åº“
sudo bash /root/coke-nof1/deploy/scripts/init_mysql.sh
```

### SSLè¯ä¹¦ç”³è¯·å¤±è´¥
```bash
# æ£€æŸ¥DNSæ˜¯å¦ç”Ÿæ•ˆ
ping nof1.coke-twitter.com
nslookup nof1.coke-twitter.com

# æ‰‹åŠ¨ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d nof1.coke-twitter.com

# æŸ¥çœ‹è¯ä¹¦çŠ¶æ€
sudo certbot certificates
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- **å®Œæ•´éƒ¨ç½²æŒ‡å—**: [DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md)
- **éƒ¨ç½²æ£€æŸ¥æ¸…å•**: [DEPLOYMENT_CHECKLIST.md](./DEPLOYMENT_CHECKLIST.md)
- **å¿«é€Ÿå¼€å§‹**: [README.md](./README.md)

## ğŸ”— ç›¸å…³é“¾æ¥

- PM2æ–‡æ¡£: https://pm2.keymetrics.io/
- Nginxæ–‡æ¡£: https://nginx.org/
- Let's Encrypt: https://letsencrypt.org/
- Node.jsæœ€ä½³å®è·µ: https://github.com/goldbergyoni/nodebestpractices

---

**éƒ¨ç½²å®Œæˆå**ï¼Œç½‘ç«™å°†åœ¨ä»¥ä¸‹åœ°å€è®¿é—®ï¼š
ğŸŒ **https://nof1.coke-twitter.com**
