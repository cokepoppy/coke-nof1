# 实时行情 - 快速开始

## ✅ 已实现功能

系统现在通过 **CoinGecko API** 拉取并显示实时加密货币价格！

### 支持的币种
- 🪙 BTC (Bitcoin)
- 💎 ETH (Ethereum)
- ☀️ SOL (Solana)
- 🟡 BNB (Binance Coin)
- 🐕 DOGE (Dogecoin)
- 💧 XRP (Ripple)

### 显示信息
- 实时价格（USD）
- 24小时涨跌幅（%）
- 24小时成交量
- 绿色表示上涨 📈
- 红色表示下跌 📉

## 🚀 立即开始

### 1. 启动后端
```bash
cd backend
npm install
npm run dev
```

你会看到类似输出：
```
Initializing CoinGecko market data service...
Price update: BTC = $103357.00 (+2.79%)
Price update: ETH = $3405.73 (+4.67%)
...
CoinGecko service initialized successfully
```

### 2. 启动前端
```bash
cd frontend
npm install
npm run dev
```

### 3. 打开浏览器
访问: http://localhost:5173

实时价格将显示在页面顶部！

## ⚡ 特点

- **无需 API 密钥**：CoinGecko 公开 API，开箱即用
- **全球可用**：不受地区限制
- **自动更新**：每 10 秒拉取最新价格
- **实时推送**：通过 WebSocket 推送到前端
- **自动重连**：网络故障自动恢复

## 📊 更新频率

| 指标 | 值 |
|------|-----|
| 轮询间隔 | 10 秒 |
| API 限制 | 50 次/分钟（免费） |
| 当前使用 | 6 次/分钟 |
| 推送延迟 | < 1 秒 |

## 🔧 自定义配置

### 修改更新频率

编辑 `backend/src/services/coinGeckoService.ts`:

```typescript
// 改为 15 秒（更稳定）
setInterval(() => { this.fetchPrices(); }, 15000);
```

### 添加新币种

编辑 `backend/src/services/coinGeckoService.ts`:

```typescript
private coinIds: { [key: string]: string } = {
  // 现有币种...
  'ADA': 'cardano',      // 新增
  'MATIC': 'matic-network', // 新增
};
```

查询 Coin ID: https://www.coingecko.com/

## 🐛 故障排查

### 问题：后端无法连接

**解决方案**：
1. 检查网络连接
2. 查看控制台日志
3. 等待 10 秒自动重试

### 问题：前端不显示价格

**解决方案**：
1. 确认后端正在运行
2. 检查浏览器控制台 WebSocket 连接
3. 刷新页面

### 问题：价格更新缓慢

**原因**：CoinGecko 免费版每 10 秒更新一次

**解决方案**：
- 保持现状（已是最优配置）
- 或升级到 CoinGecko Pro（更高频率）

## 📝 技术栈

### 后端
- Node.js + TypeScript
- Axios (HTTP 客户端)
- Socket.IO (实时通信)
- CoinGecko API

### 前端
- React + TypeScript
- Redux Toolkit (状态管理)
- Socket.IO Client
- Custom useWebSocket Hook

## 🌟 下一步

- [x] 集成实时价格
- [x] WebSocket 推送
- [x] 24小时涨跌幅
- [ ] 价格历史图表
- [ ] 价格告警
- [ ] 更多币种

## 📚 相关文档

- [详细配置指南](./实时行情配置.md)
- [CoinGecko API 文档](https://www.coingecko.com/en/api/documentation)
- [系统设计方案](./设计方案.md)

---

**注意**：当前使用 CoinGecko 免费 API，每分钟最多 50 次请求。我们的配置远低于此限制，确保稳定运行。
